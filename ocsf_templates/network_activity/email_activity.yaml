# OCSF Gold Mapping Template: email_activity
# Class UID: 4009 | Category: Network Activity
#
# Email Activity events capture email sending, receiving, and filtering.

gold:
  - name: email_activity
    input: <YOUR_SILVER_TABLE_NAME>
    fields:
      - name: activity_id
        expr: # 1=Send, 2=Receive, 3=Quarantine, 4=Drop, 5=Deliver
      - name: activity_name
        expr: 
      - name: category_uid
        literal: 4
      - name: category_name
        literal: Network Activity
      - name: class_uid
        literal: 4009
      - name: class_name
        literal: Email Activity
      - name: severity_id
        expr: 
      - name: time
        from: 
      - name: type_uid
        expr: 
      - name: type_name
        expr: 
      - name: email.to
        expr: # Recipient email address
      - name: src_endpoint.ip
        expr: # Sender IP
      - name: src_endpoint.hostname
        expr: # Sender hostname
      - name: dst_endpoint.ip
        expr: # Recipient server IP
      - name: dst_endpoint.hostname
        expr: # Recipient hostname
      - name: protocol_name
        expr: # smtp, pop3, imap
      - name: direction_id
        expr: # 1=Inbound, 2=Outbound, 3=Internal
      - name: direction
        expr: 
      - name: message_trace_uid
        expr: # Message tracking ID
      - name: disposition_id
        expr: # 1=Allowed, 2=Blocked, 3=Quarantined
      - name: disposition
        expr: 
      - name: status_id
        expr: 
      - name: metadata.product.name
        literal: 
      - name: metadata.product.vendor_name
        literal: 
      - name: metadata.logged_time
        from: 
      - name: metadata.processed_time
        expr: current_timestamp()
      - name: metadata.uid
        expr: 
      - name: raw_data
        from: 

